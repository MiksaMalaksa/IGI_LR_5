{% extends 'base.html' %}

{% block title %}
<a href="{% url 'news' %}" style="color: rgb(75, 75, 240); text-decoration: none;">
    Home
</a>
{% endblock %}

{% block content %}
<h1 style="display: inline-block; margin-right: 10px; font-size: 24px;">Home</h1>
<div style="display: inline-block;">
  {% if username %}
    <p style="display: inline-block; font-weight: bold; color: black; font-size: 24px;">
      Hello {{ username }} {{ user_timezone }} - {{ current_date_formatted }}
    </p>
    <br>
    {% if quote %}
      <p style="display: inline-block; font-weight: bold; color: black; font-size: 24px;">
        Quote of the moment: {{ quote }}
      </p>
    {% endif %}
  {% endif %}
</div>


{% if latest_article %}
<h2>
    <a href="{% url 'article_detail' latest_article.id %}" style="color: rgb(67, 21, 217); text-decoration: none;">
        {{ latest_article.title }}
    </a>
    - the latest piece of news!
</h2>
{% else %}
<p>Nothing for now!</p>
{% endif %}
<pre style="font-size: 16px;">{{ calendar_text }}</pre>

<h2>Properties</h2>

<!-- Sorting Options -->
<div style="margin-bottom: 20px;">
    <form method="get" action="{% url 'home' %}">
        <div style="display: flex; gap: 10px; margin-bottom: 10px;">
            <div style="flex: 1; min-width: 200px;">
                <label for="sort_price">Sort by price:</label>
                <select id="sort_price" name="sort_price"
                    style="width: 100%; padding: 5px; border-radius: 5px; border: 1px solid rgb(75, 75, 240);">
                    <option value="none">None</option>
                    <option value="ascending_price">Ascending</option>
                    <option value="descending_price">Descending</option>
                </select>
            </div>
            <div style="flex: 1; min-width: 200px;">
                <label for="sort_area">Sort by area:</label>
                <select id="sort_area" name="sort_area"
                    style="width: 100%; padding: 5px; border-radius: 5px; border: 1px solid rgb(75, 75, 240);">
                    <option value="none">None</option>
                    <option value="ascending_area">Ascending</option>
                    <option value="descending_area">Descending</option>
                </select>
            </div>
        </div>

        <!-- Price Filters -->
        <div style="display: flex; gap: 10px; margin-bottom: 10px;">
            <div style="flex: 1; min-width: 200px;">
                <label for="min_price">Min price:</label>
                <input type="number" id="min_price" name="min_price"
                    style="width: 100%; padding: 5px; border-radius: 5px; border: 1px solid rgb(75, 75, 240);">
            </div>
            <div style="flex: 1; min-width: 200px;">
                <label for="max_price">Max price:</label>
                <input type="number" id="max_price" name="max_price"
                    style="width: 100%; padding: 5px; border-radius: 5px; border: 1px solid rgb(75, 75, 240);">
            </div>
        </div>

        <!-- Area Filters -->
        <div style="display: flex; gap: 10px; margin-bottom: 10px;">
            <div style="flex: 1; min-width: 200px;">
                <label for="min_area">Min area:</label>
                <input type="number" id="min_area" name="min_area"
                    style="width: 100%; padding: 5px; border-radius: 5px; border: 1px solid rgb(75, 75, 240);">
            </div>
            <div style="flex: 1; min-width: 200px;">
                <label for="max_area">Max area:</label>
                <input type="number" id="max_area" name="max_area"
                    style="width: 100%; padding: 5px; border-radius: 5px; border: 1px solid rgb(75, 75, 240);">
            </div>
        </div>

        <!-- Title Filter -->
        <div style="display: flex; gap: 10px; margin-bottom: 10px;">
            <div style="flex: 1; min-width: 200px;">
                <label for="title">Title:</label>
                <input type="text" id="title" name="title"
                    style="width: 100%; padding: 5px; border-radius: 5px; border: 1px solid rgb(75, 75, 240);">
            </div>
        </div>

        <!-- Submit Button -->
        <div style="display: flex; gap: 10px; margin-bottom: 20px;">
            <div style="flex: 1; min-width: 200px;">
                <button type="submit"
                    style="width: 100%; padding: 10px; background-color: rgb(75, 75, 240); color: white; border: none; border-radius: 5px; cursor: pointer; font-size: 16px;">Apply</button>
            </div>
        </div>
    </form>
</div>

<div style="display: flex; flex-wrap: wrap;">
    {% for property in properties %}
    <div style="margin-right: 20px; margin-bottom: 20px; border: 1px solid black; padding: 10px;">
        <h3>{{ property.title }}</h3>
        <p>Price: {{ property.price }}</p>
        <p>Location: {{ property.location }}</p>
        <p>Floor: {{ property.floor }}</p>
        <p>Square Meters: {{ property.square_meters }}</p>
        <a href="{% url 'property_detail' property.id %}"><img src="{{ property.image.url }}" alt="{{ property.title }}"
                style="max-width: 300px;"></a>
        {% if is_admin %}
        <div style="margin-top: 10px;">
            <button
                style="padding: 5px 10px; background-color: #4CAF50; color: white; border: none; border-radius: 5px; cursor: pointer;">Change</button>
            <button
                style="padding: 5px 10px; background-color: #f44336; color: white; border: none; border-radius: 5px; cursor: pointer;">Delete</button>
        </div>
        {% endif %}
    </div>
    {% empty %}
    <p>No properties available</p>
    {% endfor %}
</div>

{% endblock %}